<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<link href="stylesheets/styles.css" rel="stylesheet" type="text/css" />
	<title>Posts</title>
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.2.18.min.js"></script>
	<style type="text/css">
		#field {
    margin-bottom:20px;
		}
	</style>
  
</head>
<body>
		<div id="loginresults"></div>

		<div class="row">
			<div class="span2"></div>
			<div class="span8 well" >
			   <div class="container">
						<div class="row">
							<input type="hidden" name="count" value="1" />
					        <div class="control-group" id="fields">
					            <label class="control-label" for="field1">寫下您的期待：</label>
					            <div class="controls" id="profs"> 
					                <form class="input-append">
					                    <div id="field"><input autocomplete="off" class="input" id="field1" name="prof1" type="text" placeholder="Type something" data-items="8"/><button id="b1" class="btn add-more" type="button">+</button></div>
					                </form>
					            <br>
					            <small>Press + to add another form field :)</small>
					            </div>
					            <div>
												<button class="btn btn-primary" id="addpublicmessageButton">Create Post</button>
											</div>
					        </div>
						</div>
					</div>
			</div>
			<div class="span2"></div>
		</div>

		<!-- Le javascript
    ================================================== -->
    <script src="javascripts/bootstrap-transition.js"></script>
    <script src="javascripts/bootstrap-alert.js"></script>
    <script src="javascripts/bootstrap-modal.js"></script>
    <script src="javascripts/bootstrap-dropdown.js"></script>
    <script src="javascripts/bootstrap-scrollspy.js"></script>
    <script src="javascripts/bootstrap-tab.js"></script>
    <script src="javascripts/bootstrap-tooltip.js"></script>
    <script src="javascripts/bootstrap-popover.js"></script>
    <script src="javascripts/bootstrap-button.js"></script>
    <script src="javascripts/bootstrap-collapse.js"></script>
    <script src="javascripts/bootstrap-carousel.js"></script>
    <script src="javascripts/bootstrap-typeahead.js"></script>


    <script type="text/javascript">
 			Parse.initialize("Y3hVWxIZt8ONbc5ChxiGERkvUAu40FzN9z8Kuj1j", "i2b1fioEWPxGLmFUlLFl6MGoFVJN9XIOzb4RmOUj");

	    var addpublicmessageButton = document.getElementById('addpublicmessageButton');
	    addpublicmessageButton.onclick = handleaddpublicmessageButtonClick;


	    function handleaddpublicmessageButtonClick() {
	      var public_message_content = document.getElementById('field1').value;

	      var Message = Parse.Object.extend("Message");
	      var publicMessage = new Message();
	      var meaasgeACL = new Parse.ACL(Parse.User.current());
	      meaasgeACL.setPublicReadAccess(true);
	      publicMessage.setACL(meaasgeACL);
	      publicMessage.set("textcontent", public_message_content);
	      publicMessage.set("creator", Parse.User.current());
	      publicMessage.save();

	      $( "#loginresults" ).empty();
	      $( "#loginresults" ).append("Public Message Seted!<br />");
	    }

	    var currentUser = Parse.User.current();
	    if (currentUser) {
	      // do stuff with the user
	      $( "#loginresults" ).empty();
        $( "#loginresults" ).append("User has Logined!<br />");
        $( "#loginresults" ).append(currentUser.id + ' - ' + 
                          currentUser.getUsername() + ' - ' +
                          currentUser.getEmail() + ' - ' + 
                          currentUser.get("phone") + ' - ' +  
                          currentUser.updatedAt + ' <br /> ');

      }



			$(document).ready(function(){
			  var next = 1;
			  $(".add-more").click(function(e){
			      e.preventDefault();
			      var addto = "#field" + next;
			      var addRemove = "#field" + (next);
			      next = next + 1;
			      var newIn = '<input autocomplete="off" class="input form-control" id="field' + next + '" name="field' + next + '" type="text">';
			      var newInput = $(newIn);
			      var removeBtn = '<button id="remove' + (next - 1) + '" class="btn btn-danger remove-me" >-</button></div><div id="field">';
			      var removeButton = $(removeBtn);
			      $(addto).after(newInput);
			      $(addRemove).after(removeButton);
			      $("#field" + next).attr('data-source',$(addto).attr('data-source'));
			      $("#count").val(next);  
			      
			          $('.remove-me').click(function(e){
			              e.preventDefault();
			              var fieldNum = this.id.substr(this.id.lastIndexOf("e")+1);
			              var fieldID = "#field" + fieldNum;
			              $(this).remove();
			              $(fieldID).remove();
			          });
			  });    
			});

    </script>
	
</body>
</html>